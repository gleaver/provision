---
- hosts: all
  connection: local
  user: root
  gather_facts: no

  tasks:
  - name: install sudo
    pacman: name=sudo state=installed

  - name: ensure user
    user:
      name={{ username }}
      state=present
      groups=audio,video,games,rfkill,uucp,wheel,sys
      append=yes

  - name: sudo with wheel
    lineinfile:
      dest=/etc/sudoers
      line='%wheel ALL=(ALL) ALL'
      validate='visudo -cf %s'

  - name: core packages
    pacman: name={{ item }} state=installed
    with_items:
    - git
    - openssh
    - vim

  - name: install gui
    pacman: name=gnome state=installed

  - name: enable network
    service: name=NetworkManager state=started enabled=yes
